<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Dashboards project</title>
  <meta name="description" content="A guide to authoring books with R Markdown, including how to generate figures and tables, and insert cross-references, citations, HTML widgets, and Shiny apps in R Markdown. The book can be exported to HTML, PDF, and e-books (e.g. EPUB). The book style is customizable. You can easily write and preview the book in RStudio IDE or other editors, and host the book wherever you want (e.g. bookdown.org).">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Dashboards project" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://folkehelseinstituttet.github.io/dashboards/" />
  <meta property="og:image" content="https://folkehelseinstituttet.github.io/dashboards/images/fhi.svg" />
  <meta property="og:description" content="A guide to authoring books with R Markdown, including how to generate figures and tables, and insert cross-references, citations, HTML widgets, and Shiny apps in R Markdown. The book can be exported to HTML, PDF, and e-books (e.g. EPUB). The book style is customizable. You can easily write and preview the book in RStudio IDE or other editors, and host the book wherever you want (e.g. bookdown.org)." />
  <meta name="github-repo" content="folkehelseinstituttet/dashboards" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Dashboards project" />
  
  <meta name="twitter:description" content="A guide to authoring books with R Markdown, including how to generate figures and tables, and insert cross-references, citations, HTML widgets, and Shiny apps in R Markdown. The book can be exported to HTML, PDF, and e-books (e.g. EPUB). The book style is customizable. You can easily write and preview the book in RStudio IDE or other editors, and host the book wherever you want (e.g. bookdown.org)." />
  <meta name="twitter:image" content="https://folkehelseinstituttet.github.io/dashboards/images/fhi.svg" />

<meta name="author" content="Richard White">


<meta name="date" content="2018-11-09">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="umbrella.html">
<link rel="next" href="r-packages.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />










<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Dashboards</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#executive-summary"><i class="fa fa-check"></i><b>1.1</b> Executive summary</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#what-is-an-automated-analysis"><i class="fa fa-check"></i><b>1.2</b> What is an automated analysis?</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#why-not-have-one-project-for-each-automated-analysis"><i class="fa fa-check"></i><b>1.3</b> Why not have one project for each automated analysis?</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#important-repositories"><i class="fa fa-check"></i><b>1.4</b> Important repositories</a><ul>
<li class="chapter" data-level="1.4.1" data-path="introduction.html"><a href="introduction.html#infrastructure"><i class="fa fa-check"></i><b>1.4.1</b> Infrastructure</a></li>
<li class="chapter" data-level="1.4.2" data-path="introduction.html"><a href="introduction.html#automated-analyses-r-packages"><i class="fa fa-check"></i><b>1.4.2</b> Automated analyses R packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="umbrella.html"><a href="umbrella.html"><i class="fa fa-check"></i><b>2</b> Umbrella Infrastructure</a><ul>
<li class="chapter" data-level="2.1" data-path="umbrella.html"><a href="umbrella.html#physical-hardware-and-subscriptions"><i class="fa fa-check"></i><b>2.1</b> Physical Hardware and Subscriptions</a><ul>
<li class="chapter" data-level="2.1.1" data-path="umbrella.html"><a href="umbrella.html#requirements---smhb"><i class="fa fa-check"></i><b>2.1.1</b> Requirements - smhb</a></li>
<li class="chapter" data-level="2.1.2" data-path="umbrella.html"><a href="umbrella.html#requirements---linux"><i class="fa fa-check"></i><b>2.1.2</b> Requirements - linux</a></li>
<li class="chapter" data-level="2.1.3" data-path="umbrella.html"><a href="umbrella.html#requirements---dev"><i class="fa fa-check"></i><b>2.1.3</b> Requirements - dev</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="umbrella.html"><a href="umbrella.html#configuration-scripts-etc."><i class="fa fa-check"></i><b>2.2</b> Configuration, Scripts, etc.</a><ul>
<li class="chapter" data-level="2.2.1" data-path="umbrella.html"><a href="umbrella.html#dashboards_folderdashboards_controlbindev_down.sh"><i class="fa fa-check"></i><b>2.2.1</b> $DASHBOARDS_FOLDER/dashboards_control/bin/dev_down.sh</a></li>
<li class="chapter" data-level="2.2.2" data-path="umbrella.html"><a href="umbrella.html#dashboards_folderdashboards_controlbindev_up.sh"><i class="fa fa-check"></i><b>2.2.2</b> $DASHBOARDS_FOLDER/dashboards_control/bin/dev_up.sh</a></li>
<li class="chapter" data-level="2.2.3" data-path="umbrella.html"><a href="umbrella.html#dashboards_folderdashboards_controlbindocker_build.sh"><i class="fa fa-check"></i><b>2.2.3</b> $DASHBOARDS_FOLDER/dashboards_control/bin/docker_build.sh</a></li>
<li class="chapter" data-level="2.2.4" data-path="umbrella.html"><a href="umbrella.html#dashboards_folderdashboards_controlbindocker_login.sh"><i class="fa fa-check"></i><b>2.2.4</b> $DASHBOARDS_FOLDER/dashboards_control/bin/docker_login.sh</a></li>
<li class="chapter" data-level="2.2.5" data-path="umbrella.html"><a href="umbrella.html#dashboards_folderdashboards_controlbindocker_push_test_to_prod.sh"><i class="fa fa-check"></i><b>2.2.5</b> $DASHBOARDS_FOLDER/dashboards_control/bin/docker_push_test_to_prod.sh</a></li>
<li class="chapter" data-level="2.2.6" data-path="umbrella.html"><a href="umbrella.html#dashboards_folderdashboards_controlbinprod_down.sh"><i class="fa fa-check"></i><b>2.2.6</b> $DASHBOARDS_FOLDER/dashboards_control/bin/prod_down.sh</a></li>
<li class="chapter" data-level="2.2.7" data-path="umbrella.html"><a href="umbrella.html#dashboards_folderdashboards_controlbinprod_up.sh"><i class="fa fa-check"></i><b>2.2.7</b> $DASHBOARDS_FOLDER/dashboards_control/bin/prod_up.sh</a></li>
<li class="chapter" data-level="2.2.8" data-path="umbrella.html"><a href="umbrella.html#dashboards_folderdashboards_controlbinprod_update.sh"><i class="fa fa-check"></i><b>2.2.8</b> $DASHBOARDS_FOLDER/dashboards_control/bin/prod_update.sh</a></li>
<li class="chapter" data-level="2.2.9" data-path="umbrella.html"><a href="umbrella.html#dashboards_folderdashboards_controlbinpublic.sh"><i class="fa fa-check"></i><b>2.2.9</b> $DASHBOARDS_FOLDER/dashboards_control/bin/public.sh</a></li>
<li class="chapter" data-level="2.2.10" data-path="umbrella.html"><a href="umbrella.html#test_noispiah"><i class="fa fa-check"></i><b>2.2.10</b> $DASHBOARDS_FOLDER/dashboards_control/bin/test_noispiah.sh</a></li>
<li class="chapter" data-level="2.2.11" data-path="umbrella.html"><a href="umbrella.html#dashboards_folderdashboards_controlbintest_normomo.sh"><i class="fa fa-check"></i><b>2.2.11</b> $DASHBOARDS_FOLDER/dashboards_control/bin/test_normomo.sh</a></li>
<li class="chapter" data-level="2.2.12" data-path="umbrella.html"><a href="umbrella.html#dashboards_folderdashboards_controlbintest_sykdomspuls_log.sh"><i class="fa fa-check"></i><b>2.2.12</b> $DASHBOARDS_FOLDER/dashboards_control/bin/test_sykdomspuls_log.sh</a></li>
<li class="chapter" data-level="2.2.13" data-path="umbrella.html"><a href="umbrella.html#dashboards_folderdashboards_controlbintest_sykdomspuls_pdf.sh"><i class="fa fa-check"></i><b>2.2.13</b> $DASHBOARDS_FOLDER/dashboards_control/bin/test_sykdomspuls_pdf.sh</a></li>
<li class="chapter" data-level="2.2.14" data-path="umbrella.html"><a href="umbrella.html#dashboards_folderdashboards_controlbintest_sykdomspuls.sh"><i class="fa fa-check"></i><b>2.2.14</b> $DASHBOARDS_FOLDER/dashboards_control/bin/test_sykdomspuls.sh</a></li>
<li class="chapter" data-level="2.2.15" data-path="umbrella.html"><a href="umbrella.html#dashboards_folderdashboards_controlinfrastructuredashboards_radd_autofs.sh"><i class="fa fa-check"></i><b>2.2.15</b> $DASHBOARDS_FOLDER/dashboards_control/infrastructure/dashboards_r/add_autofs.sh</a></li>
<li class="chapter" data-level="2.2.16" data-path="umbrella.html"><a href="umbrella.html#dashboards_folderdashboards_controlinfrastructuredashboards_radd_cron.sh"><i class="fa fa-check"></i><b>2.2.16</b> $DASHBOARDS_FOLDER/dashboards_control/infrastructure/dashboards_r/add_cron.sh</a></li>
<li class="chapter" data-level="2.2.17" data-path="umbrella.html"><a href="umbrella.html#dashboards_folderdashboards_controlinfrastructuredashboards_rauto.mounts"><i class="fa fa-check"></i><b>2.2.17</b> $DASHBOARDS_FOLDER/dashboards_control/infrastructure/dashboards_r/auto.mounts</a></li>
<li class="chapter" data-level="2.2.18" data-path="umbrella.html"><a href="umbrella.html#dashboards_folderdashboards_controlinfrastructuredashboards_rcrontab"><i class="fa fa-check"></i><b>2.2.18</b> $DASHBOARDS_FOLDER/dashboards_control/infrastructure/dashboards_r/crontab</a></li>
<li class="chapter" data-level="2.2.19" data-path="umbrella.html"><a href="umbrella.html#dashboards_folderdashboards_controlinfrastructuredashboards_rdockerfile"><i class="fa fa-check"></i><b>2.2.19</b> $DASHBOARDS_FOLDER/dashboards_control/infrastructure/dashboards_r/Dockerfile</a></li>
<li class="chapter" data-level="2.2.20" data-path="umbrella.html"><a href="umbrella.html#dashboards_folderdashboards_controlinfrastructuredashboards_remails_sykdomspuls_alert_test.xlsx"><i class="fa fa-check"></i><b>2.2.20</b> $DASHBOARDS_FOLDER/dashboards_control/infrastructure/dashboards_r/emails_sykdomspuls_alert_test.xlsx</a></li>
<li class="chapter" data-level="2.2.21" data-path="umbrella.html"><a href="umbrella.html#dashboards_folderdashboards_controlinfrastructuredashboards_remails_sykdomspuls_alert.xlsx"><i class="fa fa-check"></i><b>2.2.21</b> $DASHBOARDS_FOLDER/dashboards_control/infrastructure/dashboards_r/emails_sykdomspuls_alert.xlsx</a></li>
<li class="chapter" data-level="2.2.22" data-path="umbrella.html"><a href="umbrella.html#dashboards_folderdashboards_controlinfrastructuredashboards_remails.xlsx"><i class="fa fa-check"></i><b>2.2.22</b> $DASHBOARDS_FOLDER/dashboards_control/infrastructure/dashboards_r/emails.xlsx</a></li>
<li class="chapter" data-level="2.2.23" data-path="umbrella.html"><a href="umbrella.html#httroauth"><i class="fa fa-check"></i><b>2.2.23</b> $DASHBOARDS_FOLDER/dashboards_control/infrastructure/dashboards_r/httr-oauth_2017_09_17</a></li>
<li class="chapter" data-level="2.2.24" data-path="umbrella.html"><a href="umbrella.html#dashboards_folderdashboards_controlinfrastructuredashboards_rmail.json"><i class="fa fa-check"></i><b>2.2.24</b> $DASHBOARDS_FOLDER/dashboards_control/infrastructure/dashboards_r/mail.json</a></li>
<li class="chapter" data-level="2.2.25" data-path="umbrella.html"><a href="umbrella.html#dashboards_folderdashboards_controlinfrastructuredashboards_rrepo-key"><i class="fa fa-check"></i><b>2.2.25</b> $DASHBOARDS_FOLDER/dashboards_control/infrastructure/dashboards_r/repo-key</a></li>
<li class="chapter" data-level="2.2.26" data-path="umbrella.html"><a href="umbrella.html#dashboards_folderdashboards_controlinfrastructuredashboards_rsecret.sh"><i class="fa fa-check"></i><b>2.2.26</b> $DASHBOARDS_FOLDER/dashboards_control/infrastructure/dashboards_r/secret.sh</a></li>
<li class="chapter" data-level="2.2.27" data-path="umbrella.html"><a href="umbrella.html#dashboards_folderdashboards_controlinfrastructuredocker-compose-api.yml"><i class="fa fa-check"></i><b>2.2.27</b> $DASHBOARDS_FOLDER/dashboards_control/infrastructure/docker-compose-api.yml</a></li>
<li class="chapter" data-level="2.2.28" data-path="umbrella.html"><a href="umbrella.html#dashboards_folderdashboards_controlinfrastructuredocker-compose-dev.yml"><i class="fa fa-check"></i><b>2.2.28</b> $DASHBOARDS_FOLDER/dashboards_control/infrastructure/docker-compose-dev.yml</a></li>
<li class="chapter" data-level="2.2.29" data-path="umbrella.html"><a href="umbrella.html#dashboards_folderdashboards_controlinfrastructuredocker-compose-prod.yml"><i class="fa fa-check"></i><b>2.2.29</b> $DASHBOARDS_FOLDER/dashboards_control/infrastructure/docker-compose-prod.yml</a></li>
<li class="chapter" data-level="2.2.30" data-path="umbrella.html"><a href="umbrella.html#dashboards_folderdashboards_controlinfrastructuredocker-compose-test.yml"><i class="fa fa-check"></i><b>2.2.30</b> $DASHBOARDS_FOLDER/dashboards_control/infrastructure/docker-compose-test.yml</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="umbrella.html"><a href="umbrella.html#analysisdocker"><i class="fa fa-check"></i><b>2.3</b> Analysis Docker Image</a><ul>
<li class="chapter" data-level="2.3.1" data-path="umbrella.html"><a href="umbrella.html#images"><i class="fa fa-check"></i><b>2.3.1</b> Images</a></li>
<li class="chapter" data-level="2.3.2" data-path="umbrella.html"><a href="umbrella.html#automated-analysis-r-packages"><i class="fa fa-check"></i><b>2.3.2</b> Automated Analysis R Packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="travis.html"><a href="travis.html"><i class="fa fa-check"></i><b>3</b> travis</a><ul>
<li class="chapter" data-level="3.0.1" data-path="travis.html"><a href="travis.html#internalfilestructure"><i class="fa fa-check"></i><b>3.0.1</b> File Structure</a></li>
<li class="chapter" data-level="3.0.2" data-path="travis.html"><a href="travis.html#cron"><i class="fa fa-check"></i><b>3.0.2</b> cron</a></li>
<li class="chapter" data-level="3.0.3" data-path="travis.html"><a href="travis.html#autofs"><i class="fa fa-check"></i><b>3.0.3</b> autofs</a></li>
<li class="chapter" data-level="3.1" data-path="travis.html"><a href="travis.html#reverse-proxy-docker-image"><i class="fa fa-check"></i><b>3.1</b> Reverse Proxy Docker Image</a></li>
<li class="chapter" data-level="3.2" data-path="travis.html"><a href="travis.html#dockercompose"><i class="fa fa-check"></i><b>3.2</b> Docker Compose</a></li>
<li class="chapter" data-level="3.3" data-path="travis.html"><a href="travis.html#production-computer---smhb"><i class="fa fa-check"></i><b>3.3</b> Production Computer - smhb</a><ul>
<li class="chapter" data-level="3.3.1" data-path="travis.html"><a href="travis.html#crontab"><i class="fa fa-check"></i><b>3.3.1</b> crontab</a></li>
<li class="chapter" data-level="3.3.2" data-path="travis.html"><a href="travis.html#file-structure"><i class="fa fa-check"></i><b>3.3.2</b> File Structure</a></li>
<li class="chapter" data-level="3.3.3" data-path="travis.html"><a href="travis.html#explanation"><i class="fa fa-check"></i><b>3.3.3</b> Explanation</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="travis.html"><a href="travis.html#integrationtesting"><i class="fa fa-check"></i><b>3.4</b> Integration Testing Computer - linux</a><ul>
<li class="chapter" data-level="3.4.1" data-path="travis.html"><a href="travis.html#file-structure-1"><i class="fa fa-check"></i><b>3.4.1</b> File Structure</a></li>
<li class="chapter" data-level="3.4.2" data-path="travis.html"><a href="travis.html#explanation-1"><i class="fa fa-check"></i><b>3.4.2</b> Explanation</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="travis.html"><a href="travis.html#travis"><i class="fa fa-check"></i><b>3.5</b> Unit Testing - travis-ci</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="r-packages.html"><a href="r-packages.html"><i class="fa fa-check"></i><b>4</b> R packages</a><ul>
<li class="chapter" data-level="4.1" data-path="r-packages.html"><a href="r-packages.html#generic"><i class="fa fa-check"></i><b>4.1</b> Generic</a><ul>
<li class="chapter" data-level="4.1.1" data-path="r-packages.html"><a href="r-packages.html#overview"><i class="fa fa-check"></i><b>4.1.1</b> Overview</a></li>
<li class="chapter" data-level="4.1.2" data-path="r-packages.html"><a href="r-packages.html#requirements"><i class="fa fa-check"></i><b>4.1.2</b> Requirements</a></li>
<li class="chapter" data-level="4.1.3" data-path="r-packages.html"><a href="r-packages.html#deployment-via-travis-ci-and-drat"><i class="fa fa-check"></i><b>4.1.3</b> Deployment via travis-ci and drat</a></li>
<li class="chapter" data-level="4.1.4" data-path="r-packages.html"><a href="r-packages.html#integration-with-the-local-file-system"><i class="fa fa-check"></i><b>4.1.4</b> Integration with the local file system</a></li>
<li class="chapter" data-level="4.1.5" data-path="r-packages.html"><a href="r-packages.html#RunProcess"><i class="fa fa-check"></i><b>4.1.5</b> inst/src/RunProcess.R</a></li>
<li class="chapter" data-level="4.1.6" data-path="r-packages.html"><a href="r-packages.html#instsrcruntest.r"><i class="fa fa-check"></i><b>4.1.6</b> inst/src/RunTest.R</a></li>
<li class="chapter" data-level="4.1.7" data-path="r-packages.html"><a href="r-packages.html#Runsh"><i class="fa fa-check"></i><b>4.1.7</b> inst/bin/0_run.sh</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="contributingquickstart.html"><a href="contributingquickstart.html"><i class="fa fa-check"></i><b>5</b> Contributing/Quickstart</a><ul>
<li class="chapter" data-level="5.1" data-path="contributingquickstart.html"><a href="contributingquickstart.html#quickstart"><i class="fa fa-check"></i><b>5.1</b> Quickstart</a></li>
<li class="chapter" data-level="5.2" data-path="contributingquickstart.html"><a href="contributingquickstart.html#newautomatedanalysis"><i class="fa fa-check"></i><b>5.2</b> New Automated Analysis</a></li>
<li class="chapter" data-level="5.3" data-path="contributingquickstart.html"><a href="contributingquickstart.html#development-guidelines"><i class="fa fa-check"></i><b>5.3</b> Development guidelines</a></li>
<li class="chapter" data-level="5.4" data-path="contributingquickstart.html"><a href="contributingquickstart.html#code-style"><i class="fa fa-check"></i><b>5.4</b> Code style</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://www.fhi.no/" target="blank">www.fhi.no</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Dashboards project</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="travis" class="section level1">
<h1><span class="header-section-number">3</span> travis</h1>
<div id="internalfilestructure" class="section level3">
<h3><span class="header-section-number">3.0.1</span> File Structure</h3>
<p>Inside <code>raw996/dashboards_r</code> we have the following file structure:</p>
<pre><code>/data_raw/
  |-- normomo/
  |-- noispiah/
  |-- sykdomspuls/
  |-- sykdomspuls_pdf/
  |-- sykdomspuls_log/
/data_clean/
  |-- normomo/
  |-- noispiah/
  |-- sykdomspuls/
  |-- sykdomspuls_pdf/
  |-- sykdomspuls_log/
/data_app/
  |-- normomo/
  |-- noispiah/
  |-- sykdomspuls/
  |-- sykdomspuls_pdf/
  |-- sykdomspuls_log/
/results/
  |-- normomo/
  |-- noispiah/
  |-- sykdomspuls/
  |-- sykdomspuls_pdf/
  |-- sykdomspuls_log/
/usr/local/lib/R/site-library/  &lt;soft linked to /r&gt;
  |-- &lt;OTHER R PACKAGES INSTALLED HERE&gt;/
  |-- fhi/
  |-- normomo/
  |-- noispiah/
  |-- sykdomspuls/
  |-- sykdomspuls_pdf/
  |-- sykdomspuls_log/
  |-- &lt;OTHER R PACKAGES INSTALLED HERE&gt;/</code></pre>
<p>Note that we have a soft link between <code>/r</code> and <code>/usr/local/lib/R/site-library/</code>.</p>
</div>
<div id="cron" class="section level3">
<h3><span class="header-section-number">3.0.2</span> cron</h3>
<p>We use <a href="https://en.wikipedia.org/wiki/Cron">cron</a> to schedule the analyses. The schedule is specified in <a href="https://github.com/raubreywhite/dashboards_control/blob/master/infrastructure/dashboards_r/crontab">crontab</a>.</p>
<p>The cronjobs are only activated when the environmental variable <code>ADD=cron</code> is defined. Cronjobs are then activated through <a href="https://github.com/raubreywhite/dashboards_control/blob/master/infrastructure/dashboards_r/add_cron.sh">add_cron.sh</a>.</p>
<p>In principle, cronjobs should only be activated on <code>smhb</code>.</p>
</div>
<div id="autofs" class="section level3">
<h3><span class="header-section-number">3.0.3</span> autofs</h3>
<p>We use <a href="https://help.ubuntu.com/community/Autofs">autofs</a> to connect to the F network. The network locations, username, and password are specified in <a href="https://github.com/raubreywhite/dashboards_control/blob/master/infrastructure/dashboards_r/auto.mounts">auto.mounts</a>.</p>
<p>Autofs is only activated when the environmental variable <code>ADD_AUTOFS=yes</code> is defined. Autofs is then activated through <a href="https://github.com/raubreywhite/dashboards_control/blob/master/infrastructure/dashboards_r/add_autofs.sh">add_autofs.sh</a>.</p>
<p>In principle, autofs should only be activated on <code>smhb</code>.</p>
</div>
<div id="reverse-proxy-docker-image" class="section level2">
<h2><span class="header-section-number">3.1</span> Reverse Proxy Docker Image</h2>
<p>We use nginx as a reverse proxy to make rstudio server available to the developers.</p>
<p>The relevant Dockerfile is <a href="https://github.com/raubreywhite/dashboards_control/blob/master/infrastructure/dashboards_nginx/Dockerfile">here</a> and is pushed to <a href="https://hub.docker.com/r/raw996/dashboards_nginx/">raw996/dashboards_nginx:production</a> after integration testing is passed.</p>
</div>
<div id="dockercompose" class="section level2">
<h2><span class="header-section-number">3.2</span> Docker Compose</h2>
<p><a href="https://docs.docker.com/compose/">Docker compose</a> is used to integrate these Docker images into the local filesystem. We have multiple docker-compose files for different reasons:</p>
<ul>
<li>For <a href="https://github.com/raubreywhite/dashboards_control/blob/master/infrastructure/docker-compose-prod.yml">production</a> on <code>smhb</code></li>
<li>For <a href="https://github.com/raubreywhite/dashboards_control/blob/master/infrastructure/docker-compose-test.yml">testing</a> on <code>linux</code></li>
<li>For <a href="https://github.com/raubreywhite/dashboards_control/blob/master/infrastructure/docker-compose-dev.yml">development</a> on a dev computer</li>
</ul>
</div>
<div id="production-computer---smhb" class="section level2">
<h2><span class="header-section-number">3.3</span> Production Computer - smhb</h2>
<div id="crontab" class="section level3">
<h3><span class="header-section-number">3.3.1</span> crontab</h3>
<pre><code># m h  dom mon dow   command
5 1 * * * /home/raw996/git/dashboards_control/bin/prod_update.sh
@reboot /home/raw996/git/dashboards_control/bin/prod_update.sh</code></pre>
</div>
<div id="file-structure" class="section level3">
<h3><span class="header-section-number">3.3.2</span> File Structure</h3>
<pre><code>/home/raw996/git/dashboards_control/</code></pre>
</div>
<div id="explanation" class="section level3">
<h3><span class="header-section-number">3.3.3</span> Explanation</h3>
<p><code>smhb</code> is designed to be extremely simple. It has two jobs:</p>
<ol style="list-style-type: decimal">
<li>Updating <a href="https://hub.docker.com/r/raw996/dashboards_r/">raw996/dashboards_r:production</a>, <a href="https://hub.docker.com/r/raw996/dashboards_shiny/">raw996/dashboards_shiny:production</a>, and <a href="https://hub.docker.com/r/raw996/dashboards_nginx/">raw996/dashboards_nginx:production</a></li>
<li>Making sure that <a href="https://github.com/raubreywhite/dashboards_control/blob/master/infrastructure/docker-compose-prod.yml">docker-compose-prod.yml</a> is running</li>
</ol>
<p>We purposefully minimize all integration with the base machine, because this enables us to be deploy-environment independent and to move our deployment anywhere with minimal hassle.</p>
</div>
</div>
<div id="integrationtesting" class="section level2">
<h2><span class="header-section-number">3.4</span> Integration Testing Computer - linux</h2>
<div id="file-structure-1" class="section level3">
<h3><span class="header-section-number">3.4.1</span> File Structure</h3>
<pre><code>/home/raw996/
  |-- docker-compose-jenkins/
    |-- docker-compose.yml
  |-- data/
    |-- data_app/
      |-- normomo/
      |-- sykdomspuls/
    |-- data_clean/
      |-- normomo/
      |-- sykdomspuls/
    |-- data_raw/
      |-- normomo/
        |-- FHIDOD2_20170425.txt
      |-- sykdomspuls/
        |-- partially_formatted_2017_08_01.txt
    |-- data_results/
      |-- normomo/
      |-- sykdomspuls/
  |-- jenkins/</code></pre>
</div>
<div id="explanation-1" class="section level3">
<h3><span class="header-section-number">3.4.2</span> Explanation</h3>
<p><code>linux</code> has three jobs:</p>
<ol style="list-style-type: decimal">
<li>Building [raw996/dhadley](<a href="https://github.com/raubreywhite/docker/blob/master/dhadley/Dockerfile" class="uri">https://github.com/raubreywhite/docker/blob/master/dhadley/Dockerfile</a></li>
<li>Integration testing for the automated analyses</li>
<li>Pushing <a href="https://hub.docker.com/r/raw996/dashboards_r/">raw996/dashboards_r:production</a>, <a href="https://hub.docker.com/r/raw996/dashboards_shiny/">raw996/dashboards_shiny:production</a>, and <a href="https://hub.docker.com/r/raw996/dashboards_nginx/">raw996/dashboards_nginx:production</a> to Docker hub after successful integration testing</li>
</ol>
<p>Integration testing happens by Jenkins running:</p>
<ul>
<li><a href="https://github.com/raubreywhite/dashboards_control/blob/master/bin/test_noispiah.sh">test_noispiah.sh</a></li>
<li><a href="https://github.com/raubreywhite/dashboards_control/blob/master/bin/test_normomo.sh">test_normomo.sh</a></li>
<li><a href="https://github.com/raubreywhite/dashboards_control/blob/master/bin/test_sykdomspuls.sh">test_sykdomspuls.sh</a></li>
<li><a href="https://github.com/raubreywhite/dashboards_control/blob/master/bin/test_sykdomspulslog.sh">test_sykdomspulslog.sh</a></li>
<li><a href="https://github.com/raubreywhite/dashboards_control/blob/master/bin/test_sykdomspulspdf.sh">test_sykdomspulspdf.sh</a></li>
</ul>
</div>
</div>
<div id="travis" class="section level2">
<h2><span class="header-section-number">3.5</span> Unit Testing - travis-ci</h2>
<p><a href="http://travis-ci.org/folkehelseinstituttet">Travis-ci</a> is used for <a href="http://r-pkgs.had.co.nz/check.html#travis">unit testing of packages</a>. If the R package passes all tests, then we use <a href="https://github.com/eddelbuettel/drat">drat</a> to deploy a built version of the package to Folkehelseinstituttet’s R repository: <a href="https://folkehelseinstituttet.github.io/drat/" class="uri">https://folkehelseinstituttet.github.io/drat/</a>.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="umbrella.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="r-packages.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["website.pdf", "website.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
